// Copyright 2025 Consensys Software Inc.
// Licensed under the Apache License, Version 2.0. See the LICENSE file for details.

// Code generated by gnark DO NOT EDIT

//go:build icicle

package bls12377

import (
	"sync"

	"github.com/consensys/gnark-crypto/ecc/bls12-377/fr"
	groth16_bls12377 "github.com/consensys/gnark/backend/groth16/bls12-377"
	icicle_core "github.com/ingonyama-zk/icicle-gnark/v3/wrappers/golang/core"
)

type deviceInfo struct {
	CosetGenerator [fr.Limbs * 2]uint32

	// Pinned (persistent) vectors - only populated if PinToGPU is true
	PinnedG1Device struct {
		A, B, K, Z icicle_core.DeviceSlice
	}
	PinnedG2Device struct {
		B icicle_core.DeviceSlice
	}

	DenDevice icicle_core.DeviceSlice

	CommitmentKeysDevice struct {
		Basis         []icicle_core.DeviceSlice
		BasisExpSigma []icicle_core.DeviceSlice // we compute in batch
	}
}

type ProvingKey struct {
	groth16_bls12377.ProvingKey
	*deviceInfo
	setupMu  sync.Mutex // Protects concurrent deviceInfo initialization
	PinToGPU bool       // If true, pre-load and keep all vectors in GPU memory (default: false)
}
